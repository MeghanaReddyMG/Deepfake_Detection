{% extends "base.html" %}

{% block content %}
<div class="hero-section">
    <div class="hero-content">
        <div class="main-logo">
            <div class="logo-container">
                <div class="logo-shield">
                    <div class="shield-inner">
                        <div class="shield-icon"></div>
                    </div>
                </div>
                <h1 class="brand-name">FalsifyX</h1>
            </div>
        </div>
        <p class="hero-subtitle">Advanced AI-powered forensic analysis for digital media authentication</p>
        <p class="welcome-message">Welcome back, <strong>{{ username }}</strong></p>
    </div>
    <div class="particles">
        <div class="particle" style="left: 10%; animation-delay: 0s;"></div>
        <div class="particle" style="left: 20%; animation-delay: 2s;"></div>
        <div class="particle" style="left: 30%; animation-delay: 4s;"></div>
        <div class="particle" style="left: 40%; animation-delay: 1s;"></div>
        <div class="particle" style="left: 50%; animation-delay: 3s;"></div>
        <div class="particle" style="left: 60%; animation-delay: 5s;"></div>
        <div class="particle" style="left: 70%; animation-delay: 2.5s;"></div>
        <div class="particle" style="left: 80%; animation-delay: 4.5s;"></div>
        <div class="particle" style="left: 90%; animation-delay: 1.5s;"></div>
    </div>
</div>

<!-- Analysis Modules Selection -->
<div class="modules-container">
    <div class="modules-grid">
        <div class="module-card" data-module="image">
            <div class="module-icon">
                <div class="icon-bg">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"/>
                    </svg>
                </div>
            </div>
            <h3>Image Analysis</h3>
            <p>Check if photos are real or fake using AI detection</p>
            <div class="module-stats">
                <span id="imageBadge">0</span> analyses
            </div>
        </div>

        <div class="module-card" data-module="video">
            <div class="module-icon">
                <div class="icon-bg">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path d="M17 10.5V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4z"/>
                    </svg>
                </div>
            </div>
            <h3>Video Analysis</h3>
            <p>Detect fake videos and deepfakes in video content</p>
            <div class="module-stats">
                <span id="videoBadge">0</span> analyses
            </div>
        </div>

        <div class="module-card" data-module="audio">
            <div class="module-icon">
                <div class="icon-bg">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 2c1.1 0 2 .9 2 2v6c0 1.1-.9 2-2 2s-2-.9-2-2V4c0-1.1.9-2 2-2zm5.3 6c-.08 0-.15.04-.2.1-.05.06-.08.14-.08.23v1.17c0 2.76-2.24 5-5 5s-5-2.24-5-5V8.33c0-.09-.03-.17-.08-.23-.05-.06-.12-.1-.2-.1-.08 0-.15.04-.2.1-.05.06-.08.14-.08.23V9.5c0 3.31 2.69 6 6 6 .34 0 .68-.03 1-.08V17h2v-1.58c.32.05.66.08 1 .08 3.31 0 6-2.69 6-6V8.33c0-.09-.03-.17-.08-.23-.05-.06-.12-.1-.2-.1z"/>
                    </svg>
                </div>
            </div>
            <h3>Audio Analysis</h3>
            <p>Spot fake voices and cloned speech in audio files</p>
            <div class="module-stats">
                <span id="audioBadge">0</span> analyses
            </div>
        </div>
    </div>

    <div class="stats-summary">
        <div class="stat-card">
            <div class="stat-number" id="totalAnalyses">0</div>
            <div class="stat-label">Total Analyses</div>
        </div>
        <div class="stat-card">
            <div class="stat-number" id="fakeDetected">0</div>
            <div class="stat-label">Fakes Detected</div>
        </div>
        <div class="stat-card" id="accuracyStat">
            <div class="stat-number" id="accuracyValue">N/A</div>
            <div class="stat-label">AI Accuracy</div>
        </div>
    </div>
</div>

    <!-- Analysis Detail View -->
    <div class="analysis-detail-view hidden" id="analysisDetailView">
        <button class="back-button" id="backToModules">← Back to Modules</button>
        <div class="detail-content">
            <!-- Content will be dynamically loaded here -->
        </div>
    </div>

    <!-- Hidden Section Templates -->
    <div style="display: none;" id="sectionTemplates">
        <!-- Image Analysis Section -->
        <div id="imageSection" class="analysis-section">
            <div class="section-header">
                <h2>Image Forensics Laboratory</h2>
                <div class="section-controls">
                    <button class="control-btn" id="clearImageHistory">Clear History</button>
                </div>
            </div>

            <!-- Analysis Description -->
            <div class="analysis-description">
                <h3>Image Analysis</h3>
                <p>Upload any image to check if it's real or fake. Our AI can detect deepfakes, face swaps, and AI-generated images from tools like DALL-E, Midjourney, and others. The system looks for hidden patterns and inconsistencies that humans can't see to determine if your image is authentic or artificially created.</p>
                <div class="file-specs">
                    <div class="spec-item">
                        <strong>Supported Formats:</strong> JPG, JPEG, PNG, WebP
                    </div>
                    <div class="spec-item">
                        <strong>Maximum File Size:</strong> 100 MB
                    </div>
                    <div class="spec-item">
                        <strong>Processing Time:</strong> 3-5 seconds
                    </div>
                </div>
            </div>

            <div class="section-content">
                <!-- Detection Portal -->
                <div class="detection-portal">
                    <div class="portal-header">
                        <h3>Detection Portal</h3>
                        <div class="portal-status">
                            <span class="status-indicator active"></span>
                            <span>Neural Network: Online</span>
                        </div>
                    </div>

                    <div class="upload-area" id="imageUploadArea">
                        <div class="upload-zone" data-type="image">
                            <div class="upload-icon">IMG</div>
                            <h4>Drop Image Files Here</h4>
                            <p>Supports: JPG, PNG, JPEG, WebP (Max: 100 MB)</p>
                            <input type="file" id="imageInput" accept="image/*" multiple hidden>
                            <button class="upload-btn" onclick="document.getElementById('imageInput').click()">
                                Browse Images
                            </button>
                        </div>

                        <div id="imagePreviewArea" class="preview-area hidden">
                            <div class="preview-container">
                                <img id="imagePreview" alt="Image preview">
                                <div class="preview-overlay">
                                    <button class="action-btn analyze" id="analyzeImageBtn">Analyze</button>
                                    <button class="action-btn clear" id="clearImageBtn">Clear</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- History Panel -->
                <div class="history-panel">
                    <div class="history-header">
                        <h3>Analysis History</h3>
                        <div class="history-filter">
                            <select id="imageHistoryFilter">
                                <option value="all">All Results</option>
                                <option value="fake">Fake Only</option>
                                <option value="real">Authentic Only</option>
                            </select>
                        </div>
                    </div>
                    <div class="history-content" id="imageHistory">
                        <div class="empty-history">
                            <div class="empty-icon">HIST</div>
                            <p>No analysis history yet</p>
                            <small>Upload an image to start detecting deepfakes</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Video Analysis Section -->
        <div id="videoSection" class="analysis-section">
            <div class="section-header">
                <h2>Video Analysis Laboratory</h2>
                <div class="section-controls">
                    <button class="control-btn" id="clearVideoHistory">Clear History</button>
                </div>
            </div>

            <!-- Analysis Description -->
            <div class="analysis-description">
                <h3>Video Analysis</h3>
                <p>Upload videos to detect if they contain deepfakes or AI-generated content. Our system checks each frame for fake faces, unnatural movements, and suspicious patterns. It can spot face swaps, AI-created videos, and other digital manipulations by analyzing how people move and blink throughout the video.</p>
                <div class="file-specs">
                    <div class="spec-item">
                        <strong>Supported Formats:</strong> MP4, AVI, MOV, WebM
                    </div>
                    <div class="spec-item">
                        <strong>Maximum File Size:</strong> 100 MB
                    </div>
                    <div class="spec-item">
                        <strong>Processing Time:</strong> 5-15 seconds (depends on length)
                    </div>
                </div>
            </div>

            <div class="section-content">
                <!-- Detection Portal -->
                <div class="detection-portal">
                    <div class="portal-header">
                        <h3>Detection Portal</h3>
                        <div class="portal-status">
                            <span class="status-indicator active"></span>
                            <span>Temporal Analysis: Online</span>
                        </div>
                    </div>

                    <div class="upload-area" id="videoUploadArea">
                        <div class="upload-zone" data-type="video">
                            <div class="upload-icon">VID</div>
                            <h4>Drop Video Files Here</h4>
                            <p>Supports: MP4, AVI, MOV, WebM (Max: 100 MB)</p>
                            <input type="file" id="videoInput" accept="video/*" multiple hidden>
                            <button class="upload-btn" onclick="document.getElementById('videoInput').click()">
                                Browse Videos
                            </button>
                        </div>

                        <div id="videoPreviewArea" class="preview-area hidden">
                            <div class="preview-container">
                                <video id="videoPreview" controls></video>
                                <div class="preview-overlay">
                                    <button class="action-btn analyze" id="analyzeVideoBtn">Analyze</button>
                                    <button class="action-btn clear" id="clearVideoBtn">Clear</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- History Panel -->
                <div class="history-panel">
                    <div class="history-header">
                        <h3>Analysis History</h3>
                        <div class="history-filter">
                            <select id="videoHistoryFilter">
                                <option value="all">All Results</option>
                                <option value="fake">Fake Only</option>
                                <option value="real">Authentic Only</option>
                            </select>
                        </div>
                    </div>
                    <div class="history-content" id="videoHistory">
                        <div class="empty-history">
                            <div class="empty-icon">HIST</div>
                            <p>No analysis history yet</p>
                            <small>Upload a video to start detecting deepfakes</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Audio Analysis Section -->
        <div id="audioSection" class="analysis-section">
            <div class="section-header">
                <h2>Audio Forensics Laboratory</h2>
                <div class="section-controls">
                    <button class="control-btn" id="clearAudioHistory">Clear History</button>
                </div>
            </div>

            <!-- Analysis Description -->
            <div class="analysis-description">
                <h3>Audio Analysis</h3>
                <p>Upload audio files to check if voices are real or artificially generated. Our AI can detect voice cloning, synthetic speech, and fake audio created by text-to-speech tools. The system listens for unnatural patterns and digital fingerprints that reveal when someone's voice has been faked or cloned.</p>
                <div class="file-specs">
                    <div class="spec-item">
                        <strong>Supported Formats:</strong> MP3, WAV, OGG, M4A
                    </div>
                    <div class="spec-item">
                        <strong>Maximum File Size:</strong> 100 MB
                    </div>
                    <div class="spec-item">
                        <strong>Processing Time:</strong> 3-8 seconds (depends on length)
                    </div>
                </div>
            </div>

            <div class="section-content">
                <!-- Detection Portal -->
                <div class="detection-portal">
                    <div class="portal-header">
                        <h3>Detection Portal</h3>
                        <div class="portal-status">
                            <span class="status-indicator active"></span>
                            <span>Voice Analysis: Online</span>
                        </div>
                    </div>

                    <div class="upload-area" id="audioUploadArea">
                        <div class="upload-zone" data-type="audio">
                            <div class="upload-icon">AUD</div>
                            <h4>Drop Audio Files Here</h4>
                            <p>Supports: MP3, WAV, OGG, M4A (Max: 100 MB)</p>
                            <input type="file" id="audioInput" accept="audio/*" multiple hidden>
                            <button class="upload-btn" onclick="document.getElementById('audioInput').click()">
                                Browse Audio
                            </button>
                        </div>

                        <div id="audioPreviewArea" class="preview-area hidden">
                            <div class="preview-container">
                                <audio id="audioPreview" controls></audio>
                                <div class="preview-overlay">
                                    <button class="action-btn analyze" id="analyzeAudioBtn">Analyze</button>
                                    <button class="action-btn clear" id="clearAudioBtn">Clear</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- History Panel -->
                <div class="history-panel">
                    <div class="history-header">
                        <h3>Analysis History</h3>
                        <div class="history-filter">
                            <select id="audioHistoryFilter">
                                <option value="all">All Results</option>
                                <option value="fake">Fake Only</option>
                                <option value="real">Authentic Only</option>
                            </select>
                        </div>
                    </div>
                    <div class="history-content" id="audioHistory">
                        <div class="empty-history">
                            <div class="empty-icon">HIST</div>
                            <p>No analysis history yet</p>
                            <small>Upload audio to start detecting synthetic voices</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    </div> <!-- End of sectionTemplates -->

<!-- Analysis Modal -->
<div id="analysisModal" class="modal hidden">
    <div class="modal-content">
        <div class="modal-header">
            <h3>Neural Analysis in Progress</h3>
            <button class="modal-close" id="closeModal">×</button>
        </div>
        <div class="modal-body">
            <div class="analysis-animation">
                <div class="brain-scan"></div>
                <div class="neural-waves"></div>
            </div>
            <h4 id="analysisStatus">Initializing neural networks...</h4>
            <div class="progress-container">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <span class="progress-text" id="progressText">0%</span>
            </div>
            <p id="analysisStep">Preparing analysis pipeline...</p>
        </div>
    </div>
</div>

<!-- Results Modal -->
<div id="resultsModal" class="modal hidden">
    <div class="modal-content large">
        <div class="modal-header">
            <h3 id="resultsTitle">Analysis Results</h3>
            <button class="modal-close" id="closeResultsModal">×</button>
        </div>
        <div class="modal-body">
            <div id="resultsContent"></div>
            <div class="results-actions">
                <button class="action-btn" id="saveResults">Save Results</button>
                <button class="action-btn" id="newAnalysis">New Analysis</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}